/** Auto-generated by ipynb-to-fern-json.py - do not edit */
export default { cells: [
  {
    "type": "markdown",
    "source": "# \ud83c\udfa8 Data Designer Tutorial: Structured Outputs and Jinja Expressions\n\n#### \ud83d\udcda What you'll learn\n\nIn this notebook, we will continue our exploration of Data Designer, demonstrating more advanced data generation using structured outputs and Jinja expressions.\n\nIf this is your first time using Data Designer, we recommend starting with the [first notebook](https://nvidia-nemo.github.io/DataDesigner/latest/notebooks/1-the-basics/) in this tutorial series."
  },
  {
    "type": "markdown",
    "source": "### \ud83d\udce6 Import Data Designer\n\n- `data_designer.config` provides access to the configuration API.\n\n- `DataDesigner` is the main interface for data generation."
  },
  {
    "type": "markdown",
    "source": "### \u26a1 Colab Setup\n\nRun the cells below to install the dependencies and set up the API key. If you don't have an API key, you can generate one from [build.nvidia.com](https://build.nvidia.com)."
  },
  {
    "type": "code",
    "source": "%%capture\n!pip install -U data-designer",
    "language": "python",
    "source_html": "<span style=\"color: #666\">%%</span>capture\n<span style=\"border: 1px solid #F00\">!</span>pip install <span style=\"color: #666\">-</span>U data<span style=\"color: #666\">-</span>designer\n"
  },
  {
    "type": "code",
    "source": "import getpass\nimport os\n\nfrom google.colab import userdata\n\ntry:\n    os.environ[\"NVIDIA_API_KEY\"] = userdata.get(\"NVIDIA_API_KEY\")\nexcept userdata.SecretNotFoundError:\n    os.environ[\"NVIDIA_API_KEY\"] = getpass.getpass(\"Enter your NVIDIA API key: \")",
    "language": "python",
    "source_html": "<span style=\"color: #007020; font-weight: bold\">import</span><span style=\"color: #BBB\"> </span><span style=\"color: #0E84B5; font-weight: bold\">getpass</span>\n<span style=\"color: #007020; font-weight: bold\">import</span><span style=\"color: #BBB\"> </span><span style=\"color: #0E84B5; font-weight: bold\">os</span>\n\n<span style=\"color: #007020; font-weight: bold\">from</span><span style=\"color: #BBB\"> </span><span style=\"color: #0E84B5; font-weight: bold\">google.colab</span><span style=\"color: #BBB\"> </span><span style=\"color: #007020; font-weight: bold\">import</span> userdata\n\n<span style=\"color: #007020; font-weight: bold\">try</span>:\n    os<span style=\"color: #666\">.</span>environ[<span style=\"color: #4070A0\">&quot;NVIDIA_API_KEY&quot;</span>] <span style=\"color: #666\">=</span> userdata<span style=\"color: #666\">.</span>get(<span style=\"color: #4070A0\">&quot;NVIDIA_API_KEY&quot;</span>)\n<span style=\"color: #007020; font-weight: bold\">except</span> userdata<span style=\"color: #666\">.</span>SecretNotFoundError:\n    os<span style=\"color: #666\">.</span>environ[<span style=\"color: #4070A0\">&quot;NVIDIA_API_KEY&quot;</span>] <span style=\"color: #666\">=</span> getpass<span style=\"color: #666\">.</span>getpass(<span style=\"color: #4070A0\">&quot;Enter your NVIDIA API key: &quot;</span>)\n"
  },
  {
    "type": "code",
    "source": "import data_designer.config as dd\nfrom data_designer.interface import DataDesigner",
    "language": "python",
    "source_html": "<span style=\"color: #007020; font-weight: bold\">import</span><span style=\"color: #BBB\"> </span><span style=\"color: #0E84B5; font-weight: bold\">data_designer.config</span><span style=\"color: #BBB\"> </span><span style=\"color: #007020; font-weight: bold\">as</span><span style=\"color: #BBB\"> </span><span style=\"color: #0E84B5; font-weight: bold\">dd</span>\n<span style=\"color: #007020; font-weight: bold\">from</span><span style=\"color: #BBB\"> </span><span style=\"color: #0E84B5; font-weight: bold\">data_designer.interface</span><span style=\"color: #BBB\"> </span><span style=\"color: #007020; font-weight: bold\">import</span> DataDesigner\n"
  },
  {
    "type": "markdown",
    "source": "### \u2699\ufe0f Initialize the Data Designer interface\n\n- `DataDesigner` is the main object that is used to interface with the library.\n\n- When initialized without arguments, the [default model providers](https://nvidia-nemo.github.io/DataDesigner/latest/concepts/models/default-model-settings/) are used."
  },
  {
    "type": "code",
    "source": "data_designer = DataDesigner()",
    "language": "python",
    "source_html": "data_designer <span style=\"color: #666\">=</span> DataDesigner()\n"
  },
  {
    "type": "markdown",
    "source": "### \ud83c\udf9b\ufe0f Define model configurations\n\n- Each `ModelConfig` defines a model that can be used during the generation process.\n\n- The \"model alias\" is used to reference the model in the Data Designer config (as we will see below).\n\n- The \"model provider\" is the external service that hosts the model (see the [model config](https://nvidia-nemo.github.io/DataDesigner/latest/concepts/models/default-model-settings/) docs for more details).\n\n- By default, we use [build.nvidia.com](https://build.nvidia.com/models) as the model provider."
  },
  {
    "type": "code",
    "source": "# This name is set in the model provider configuration.\nMODEL_PROVIDER = \"nvidia\"\n\n# The model ID is from build.nvidia.com.\nMODEL_ID = \"nvidia/nemotron-3-nano-30b-a3b\"\n\n# We choose this alias to be descriptive for our use case.\nMODEL_ALIAS = \"nemotron-nano-v3\"\n\nmodel_configs = [\n    dd.ModelConfig(\n        alias=MODEL_ALIAS,\n        model=MODEL_ID,\n        provider=MODEL_PROVIDER,\n        inference_parameters=dd.ChatCompletionInferenceParams(\n            temperature=1.0,\n            top_p=1.0,\n            max_tokens=2048,\n            extra_body={\"chat_template_kwargs\": {\"enable_thinking\": False}},\n        ),\n    )\n]",
    "language": "python",
    "source_html": "<span style=\"color: #60A0B0; font-style: italic\"># This name is set in the model provider configuration.</span>\nMODEL_PROVIDER <span style=\"color: #666\">=</span> <span style=\"color: #4070A0\">&quot;nvidia&quot;</span>\n\n<span style=\"color: #60A0B0; font-style: italic\"># The model ID is from build.nvidia.com.</span>\nMODEL_ID <span style=\"color: #666\">=</span> <span style=\"color: #4070A0\">&quot;nvidia/nemotron-3-nano-30b-a3b&quot;</span>\n\n<span style=\"color: #60A0B0; font-style: italic\"># We choose this alias to be descriptive for our use case.</span>\nMODEL_ALIAS <span style=\"color: #666\">=</span> <span style=\"color: #4070A0\">&quot;nemotron-nano-v3&quot;</span>\n\nmodel_configs <span style=\"color: #666\">=</span> [\n    dd<span style=\"color: #666\">.</span>ModelConfig(\n        alias<span style=\"color: #666\">=</span>MODEL_ALIAS,\n        model<span style=\"color: #666\">=</span>MODEL_ID,\n        provider<span style=\"color: #666\">=</span>MODEL_PROVIDER,\n        inference_parameters<span style=\"color: #666\">=</span>dd<span style=\"color: #666\">.</span>ChatCompletionInferenceParams(\n            temperature<span style=\"color: #666\">=</span><span style=\"color: #40A070\">1.0</span>,\n            top_p<span style=\"color: #666\">=</span><span style=\"color: #40A070\">1.0</span>,\n            max_tokens<span style=\"color: #666\">=</span><span style=\"color: #40A070\">2048</span>,\n            extra_body<span style=\"color: #666\">=</span>{<span style=\"color: #4070A0\">&quot;chat_template_kwargs&quot;</span>: {<span style=\"color: #4070A0\">&quot;enable_thinking&quot;</span>: <span style=\"color: #007020; font-weight: bold\">False</span>}},\n        ),\n    )\n]\n"
  },
  {
    "type": "markdown",
    "source": "### \ud83c\udfd7\ufe0f Initialize the Data Designer Config Builder\n\n- The Data Designer config defines the dataset schema and generation process.\n\n- The config builder provides an intuitive interface for building this configuration.\n\n- The list of model configs is provided to the builder at initialization."
  },
  {
    "type": "code",
    "source": "config_builder = dd.DataDesignerConfigBuilder(model_configs=model_configs)",
    "language": "python",
    "source_html": "config_builder <span style=\"color: #666\">=</span> dd<span style=\"color: #666\">.</span>DataDesignerConfigBuilder(model_configs<span style=\"color: #666\">=</span>model_configs)\n"
  },
  {
    "type": "markdown",
    "source": "### \ud83e\uddd1\u200d\ud83c\udfa8 Designing our data\n\n- We will again create a product review dataset, but this time we will use structured outputs and Jinja expressions.\n\n- Structured outputs let you specify the exact schema of the data you want to generate.\n\n- Data Designer supports schemas specified using either json schema or Pydantic data models (recommended).\n\n<br>\n\nWe'll define our structured outputs using [Pydantic](https://docs.pydantic.dev/latest/) data models\n\n> \ud83d\udca1 **Why Pydantic?**\n>\n> - Pydantic models provide better IDE support and type validation.\n>\n> - They are more Pythonic than raw JSON schemas.\n>\n> - They integrate seamlessly with Data Designer's structured output system."
  },
  {
    "type": "code",
    "source": "from decimal import Decimal\nfrom typing import Literal\n\nfrom pydantic import BaseModel, Field\n\n\n# We define a Product schema so that the name, description, and price are generated\n# in one go, with the types and constraints specified.\nclass Product(BaseModel):\n    name: str = Field(description=\"The name of the product\")\n    description: str = Field(description=\"A description of the product\")\n    price: Decimal = Field(description=\"The price of the product\", ge=10, le=1000, decimal_places=2)\n\n\nclass ProductReview(BaseModel):\n    rating: int = Field(description=\"The rating of the product\", ge=1, le=5)\n    customer_mood: Literal[\"irritated\", \"mad\", \"happy\", \"neutral\", \"excited\"] = Field(\n        description=\"The mood of the customer\"\n    )\n    review: str = Field(description=\"A review of the product\")",
    "language": "python",
    "source_html": "<span style=\"color: #007020; font-weight: bold\">from</span><span style=\"color: #BBB\"> </span><span style=\"color: #0E84B5; font-weight: bold\">decimal</span><span style=\"color: #BBB\"> </span><span style=\"color: #007020; font-weight: bold\">import</span> Decimal\n<span style=\"color: #007020; font-weight: bold\">from</span><span style=\"color: #BBB\"> </span><span style=\"color: #0E84B5; font-weight: bold\">typing</span><span style=\"color: #BBB\"> </span><span style=\"color: #007020; font-weight: bold\">import</span> Literal\n\n<span style=\"color: #007020; font-weight: bold\">from</span><span style=\"color: #BBB\"> </span><span style=\"color: #0E84B5; font-weight: bold\">pydantic</span><span style=\"color: #BBB\"> </span><span style=\"color: #007020; font-weight: bold\">import</span> BaseModel, Field\n\n\n<span style=\"color: #60A0B0; font-style: italic\"># We define a Product schema so that the name, description, and price are generated</span>\n<span style=\"color: #60A0B0; font-style: italic\"># in one go, with the types and constraints specified.</span>\n<span style=\"color: #007020; font-weight: bold\">class</span><span style=\"color: #BBB\"> </span><span style=\"color: #0E84B5; font-weight: bold\">Product</span>(BaseModel):\n    name: <span style=\"color: #007020\">str</span> <span style=\"color: #666\">=</span> Field(description<span style=\"color: #666\">=</span><span style=\"color: #4070A0\">&quot;The name of the product&quot;</span>)\n    description: <span style=\"color: #007020\">str</span> <span style=\"color: #666\">=</span> Field(description<span style=\"color: #666\">=</span><span style=\"color: #4070A0\">&quot;A description of the product&quot;</span>)\n    price: Decimal <span style=\"color: #666\">=</span> Field(description<span style=\"color: #666\">=</span><span style=\"color: #4070A0\">&quot;The price of the product&quot;</span>, ge<span style=\"color: #666\">=</span><span style=\"color: #40A070\">10</span>, le<span style=\"color: #666\">=</span><span style=\"color: #40A070\">1000</span>, decimal_places<span style=\"color: #666\">=</span><span style=\"color: #40A070\">2</span>)\n\n\n<span style=\"color: #007020; font-weight: bold\">class</span><span style=\"color: #BBB\"> </span><span style=\"color: #0E84B5; font-weight: bold\">ProductReview</span>(BaseModel):\n    rating: <span style=\"color: #007020\">int</span> <span style=\"color: #666\">=</span> Field(description<span style=\"color: #666\">=</span><span style=\"color: #4070A0\">&quot;The rating of the product&quot;</span>, ge<span style=\"color: #666\">=</span><span style=\"color: #40A070\">1</span>, le<span style=\"color: #666\">=</span><span style=\"color: #40A070\">5</span>)\n    customer_mood: Literal[<span style=\"color: #4070A0\">&quot;irritated&quot;</span>, <span style=\"color: #4070A0\">&quot;mad&quot;</span>, <span style=\"color: #4070A0\">&quot;happy&quot;</span>, <span style=\"color: #4070A0\">&quot;neutral&quot;</span>, <span style=\"color: #4070A0\">&quot;excited&quot;</span>] <span style=\"color: #666\">=</span> Field(\n        description<span style=\"color: #666\">=</span><span style=\"color: #4070A0\">&quot;The mood of the customer&quot;</span>\n    )\n    review: <span style=\"color: #007020\">str</span> <span style=\"color: #666\">=</span> Field(description<span style=\"color: #666\">=</span><span style=\"color: #4070A0\">&quot;A review of the product&quot;</span>)\n"
  },
  {
    "type": "markdown",
    "source": "Next, let's design our product review dataset using a few more tricks compared to the previous notebook."
  },
  {
    "type": "code",
    "source": "# Since we often only want a few attributes from Person objects, we can\n# set drop=True in the column config to drop the column from the final dataset.\nconfig_builder.add_column(\n    dd.SamplerColumnConfig(\n        name=\"customer\",\n        sampler_type=dd.SamplerType.PERSON_FROM_FAKER,\n        params=dd.PersonFromFakerSamplerParams(),\n        drop=True,\n    )\n)\n\nconfig_builder.add_column(\n    dd.SamplerColumnConfig(\n        name=\"product_category\",\n        sampler_type=dd.SamplerType.CATEGORY,\n        params=dd.CategorySamplerParams(\n            values=[\n                \"Electronics\",\n                \"Clothing\",\n                \"Home & Kitchen\",\n                \"Books\",\n                \"Home Office\",\n            ],\n        ),\n    )\n)\n\nconfig_builder.add_column(\n    dd.SamplerColumnConfig(\n        name=\"product_subcategory\",\n        sampler_type=dd.SamplerType.SUBCATEGORY,\n        params=dd.SubcategorySamplerParams(\n            category=\"product_category\",\n            values={\n                \"Electronics\": [\n                    \"Smartphones\",\n                    \"Laptops\",\n                    \"Headphones\",\n                    \"Cameras\",\n                    \"Accessories\",\n                ],\n                \"Clothing\": [\n                    \"Men's Clothing\",\n                    \"Women's Clothing\",\n                    \"Winter Coats\",\n                    \"Activewear\",\n                    \"Accessories\",\n                ],\n                \"Home & Kitchen\": [\n                    \"Appliances\",\n                    \"Cookware\",\n                    \"Furniture\",\n                    \"Decor\",\n                    \"Organization\",\n                ],\n                \"Books\": [\n                    \"Fiction\",\n                    \"Non-Fiction\",\n                    \"Self-Help\",\n                    \"Textbooks\",\n                    \"Classics\",\n                ],\n                \"Home Office\": [\n                    \"Desks\",\n                    \"Chairs\",\n                    \"Storage\",\n                    \"Office Supplies\",\n                    \"Lighting\",\n                ],\n            },\n        ),\n    )\n)\n\nconfig_builder.add_column(\n    dd.SamplerColumnConfig(\n        name=\"target_age_range\",\n        sampler_type=dd.SamplerType.CATEGORY,\n        params=dd.CategorySamplerParams(values=[\"18-25\", \"25-35\", \"35-50\", \"50-65\", \"65+\"]),\n    )\n)\n\n# Sampler columns support conditional params, which are used if the condition is met.\n# In this example, we set the review style to rambling if the target age range is 18-25.\n# Note conditional parameters are only supported for Sampler column types.\nconfig_builder.add_column(\n    dd.SamplerColumnConfig(\n        name=\"review_style\",\n        sampler_type=dd.SamplerType.CATEGORY,\n        params=dd.CategorySamplerParams(\n            values=[\"rambling\", \"brief\", \"detailed\", \"structured with bullet points\"],\n            weights=[1, 2, 2, 1],\n        ),\n        conditional_params={\n            \"target_age_range == '18-25'\": dd.CategorySamplerParams(values=[\"rambling\"]),\n        },\n    )\n)\n\n# Optionally validate that the columns are configured correctly.\ndata_designer.validate(config_builder)",
    "language": "python",
    "source_html": "<span style=\"color: #60A0B0; font-style: italic\"># Since we often only want a few attributes from Person objects, we can</span>\n<span style=\"color: #60A0B0; font-style: italic\"># set drop=True in the column config to drop the column from the final dataset.</span>\nconfig_builder<span style=\"color: #666\">.</span>add_column(\n    dd<span style=\"color: #666\">.</span>SamplerColumnConfig(\n        name<span style=\"color: #666\">=</span><span style=\"color: #4070A0\">&quot;customer&quot;</span>,\n        sampler_type<span style=\"color: #666\">=</span>dd<span style=\"color: #666\">.</span>SamplerType<span style=\"color: #666\">.</span>PERSON_FROM_FAKER,\n        params<span style=\"color: #666\">=</span>dd<span style=\"color: #666\">.</span>PersonFromFakerSamplerParams(),\n        drop<span style=\"color: #666\">=</span><span style=\"color: #007020; font-weight: bold\">True</span>,\n    )\n)\n\nconfig_builder<span style=\"color: #666\">.</span>add_column(\n    dd<span style=\"color: #666\">.</span>SamplerColumnConfig(\n        name<span style=\"color: #666\">=</span><span style=\"color: #4070A0\">&quot;product_category&quot;</span>,\n        sampler_type<span style=\"color: #666\">=</span>dd<span style=\"color: #666\">.</span>SamplerType<span style=\"color: #666\">.</span>CATEGORY,\n        params<span style=\"color: #666\">=</span>dd<span style=\"color: #666\">.</span>CategorySamplerParams(\n            values<span style=\"color: #666\">=</span>[\n                <span style=\"color: #4070A0\">&quot;Electronics&quot;</span>,\n                <span style=\"color: #4070A0\">&quot;Clothing&quot;</span>,\n                <span style=\"color: #4070A0\">&quot;Home &amp; Kitchen&quot;</span>,\n                <span style=\"color: #4070A0\">&quot;Books&quot;</span>,\n                <span style=\"color: #4070A0\">&quot;Home Office&quot;</span>,\n            ],\n        ),\n    )\n)\n\nconfig_builder<span style=\"color: #666\">.</span>add_column(\n    dd<span style=\"color: #666\">.</span>SamplerColumnConfig(\n        name<span style=\"color: #666\">=</span><span style=\"color: #4070A0\">&quot;product_subcategory&quot;</span>,\n        sampler_type<span style=\"color: #666\">=</span>dd<span style=\"color: #666\">.</span>SamplerType<span style=\"color: #666\">.</span>SUBCATEGORY,\n        params<span style=\"color: #666\">=</span>dd<span style=\"color: #666\">.</span>SubcategorySamplerParams(\n            category<span style=\"color: #666\">=</span><span style=\"color: #4070A0\">&quot;product_category&quot;</span>,\n            values<span style=\"color: #666\">=</span>{\n                <span style=\"color: #4070A0\">&quot;Electronics&quot;</span>: [\n                    <span style=\"color: #4070A0\">&quot;Smartphones&quot;</span>,\n                    <span style=\"color: #4070A0\">&quot;Laptops&quot;</span>,\n                    <span style=\"color: #4070A0\">&quot;Headphones&quot;</span>,\n                    <span style=\"color: #4070A0\">&quot;Cameras&quot;</span>,\n                    <span style=\"color: #4070A0\">&quot;Accessories&quot;</span>,\n                ],\n                <span style=\"color: #4070A0\">&quot;Clothing&quot;</span>: [\n                    <span style=\"color: #4070A0\">&quot;Men&#39;s Clothing&quot;</span>,\n                    <span style=\"color: #4070A0\">&quot;Women&#39;s Clothing&quot;</span>,\n                    <span style=\"color: #4070A0\">&quot;Winter Coats&quot;</span>,\n                    <span style=\"color: #4070A0\">&quot;Activewear&quot;</span>,\n                    <span style=\"color: #4070A0\">&quot;Accessories&quot;</span>,\n                ],\n                <span style=\"color: #4070A0\">&quot;Home &amp; Kitchen&quot;</span>: [\n                    <span style=\"color: #4070A0\">&quot;Appliances&quot;</span>,\n                    <span style=\"color: #4070A0\">&quot;Cookware&quot;</span>,\n                    <span style=\"color: #4070A0\">&quot;Furniture&quot;</span>,\n                    <span style=\"color: #4070A0\">&quot;Decor&quot;</span>,\n                    <span style=\"color: #4070A0\">&quot;Organization&quot;</span>,\n                ],\n                <span style=\"color: #4070A0\">&quot;Books&quot;</span>: [\n                    <span style=\"color: #4070A0\">&quot;Fiction&quot;</span>,\n                    <span style=\"color: #4070A0\">&quot;Non-Fiction&quot;</span>,\n                    <span style=\"color: #4070A0\">&quot;Self-Help&quot;</span>,\n                    <span style=\"color: #4070A0\">&quot;Textbooks&quot;</span>,\n                    <span style=\"color: #4070A0\">&quot;Classics&quot;</span>,\n                ],\n                <span style=\"color: #4070A0\">&quot;Home Office&quot;</span>: [\n                    <span style=\"color: #4070A0\">&quot;Desks&quot;</span>,\n                    <span style=\"color: #4070A0\">&quot;Chairs&quot;</span>,\n                    <span style=\"color: #4070A0\">&quot;Storage&quot;</span>,\n                    <span style=\"color: #4070A0\">&quot;Office Supplies&quot;</span>,\n                    <span style=\"color: #4070A0\">&quot;Lighting&quot;</span>,\n                ],\n            },\n        ),\n    )\n)\n\nconfig_builder<span style=\"color: #666\">.</span>add_column(\n    dd<span style=\"color: #666\">.</span>SamplerColumnConfig(\n        name<span style=\"color: #666\">=</span><span style=\"color: #4070A0\">&quot;target_age_range&quot;</span>,\n        sampler_type<span style=\"color: #666\">=</span>dd<span style=\"color: #666\">.</span>SamplerType<span style=\"color: #666\">.</span>CATEGORY,\n        params<span style=\"color: #666\">=</span>dd<span style=\"color: #666\">.</span>CategorySamplerParams(values<span style=\"color: #666\">=</span>[<span style=\"color: #4070A0\">&quot;18-25&quot;</span>, <span style=\"color: #4070A0\">&quot;25-35&quot;</span>, <span style=\"color: #4070A0\">&quot;35-50&quot;</span>, <span style=\"color: #4070A0\">&quot;50-65&quot;</span>, <span style=\"color: #4070A0\">&quot;65+&quot;</span>]),\n    )\n)\n\n<span style=\"color: #60A0B0; font-style: italic\"># Sampler columns support conditional params, which are used if the condition is met.</span>\n<span style=\"color: #60A0B0; font-style: italic\"># In this example, we set the review style to rambling if the target age range is 18-25.</span>\n<span style=\"color: #60A0B0; font-style: italic\"># Note conditional parameters are only supported for Sampler column types.</span>\nconfig_builder<span style=\"color: #666\">.</span>add_column(\n    dd<span style=\"color: #666\">.</span>SamplerColumnConfig(\n        name<span style=\"color: #666\">=</span><span style=\"color: #4070A0\">&quot;review_style&quot;</span>,\n        sampler_type<span style=\"color: #666\">=</span>dd<span style=\"color: #666\">.</span>SamplerType<span style=\"color: #666\">.</span>CATEGORY,\n        params<span style=\"color: #666\">=</span>dd<span style=\"color: #666\">.</span>CategorySamplerParams(\n            values<span style=\"color: #666\">=</span>[<span style=\"color: #4070A0\">&quot;rambling&quot;</span>, <span style=\"color: #4070A0\">&quot;brief&quot;</span>, <span style=\"color: #4070A0\">&quot;detailed&quot;</span>, <span style=\"color: #4070A0\">&quot;structured with bullet points&quot;</span>],\n            weights<span style=\"color: #666\">=</span>[<span style=\"color: #40A070\">1</span>, <span style=\"color: #40A070\">2</span>, <span style=\"color: #40A070\">2</span>, <span style=\"color: #40A070\">1</span>],\n        ),\n        conditional_params<span style=\"color: #666\">=</span>{\n            <span style=\"color: #4070A0\">&quot;target_age_range == &#39;18-25&#39;&quot;</span>: dd<span style=\"color: #666\">.</span>CategorySamplerParams(values<span style=\"color: #666\">=</span>[<span style=\"color: #4070A0\">&quot;rambling&quot;</span>]),\n        },\n    )\n)\n\n<span style=\"color: #60A0B0; font-style: italic\"># Optionally validate that the columns are configured correctly.</span>\ndata_designer<span style=\"color: #666\">.</span>validate(config_builder)\n"
  },
  {
    "type": "markdown",
    "source": "Next, we will use more advanced Jinja expressions to create new columns.\n\nJinja expressions let you:\n\n- Access nested attributes: `{{ customer.first_name }}`\n\n- Combine values: `{{ customer.first_name }} {{ customer.last_name }}`\n\n- Use conditional logic: `{% if condition %}...{% endif %}`"
  },
  {
    "type": "code",
    "source": "# We can create new columns using Jinja expressions that reference\n# existing columns, including attributes of nested objects.\nconfig_builder.add_column(\n    dd.ExpressionColumnConfig(name=\"customer_name\", expr=\"{{ customer.first_name }} {{ customer.last_name }}\")\n)\n\nconfig_builder.add_column(dd.ExpressionColumnConfig(name=\"customer_age\", expr=\"{{ customer.age }}\"))\n\nconfig_builder.add_column(\n    dd.LLMStructuredColumnConfig(\n        name=\"product\",\n        prompt=(\n            \"Create a product in the '{{ product_category }}' category, focusing on products  \"\n            \"related to '{{ product_subcategory }}'. The target age range of the ideal customer is \"\n            \"{{ target_age_range }} years old. The product should be priced between $10 and $1000.\"\n        ),\n        output_format=Product,\n        model_alias=MODEL_ALIAS,\n    )\n)\n\n# We can even use if/else logic in our Jinja expressions to create more complex prompt patterns.\nconfig_builder.add_column(\n    dd.LLMStructuredColumnConfig(\n        name=\"customer_review\",\n        prompt=(\n            \"Your task is to write a review for the following product:\\n\\n\"\n            \"Product Name: {{ product.name }}\\n\"\n            \"Product Description: {{ product.description }}\\n\"\n            \"Price: {{ product.price }}\\n\\n\"\n            \"Imagine your name is {{ customer_name }} and you are from {{ customer.city }}, {{ customer.state }}. \"\n            \"Write the review in a style that is '{{ review_style }}'.\"\n            \"{% if target_age_range == '18-25' %}\"\n            \"Make sure the review is more informal and conversational.\\n\"\n            \"{% else %}\"\n            \"Make sure the review is more formal and structured.\\n\"\n            \"{% endif %}\"\n            \"The review field should contain only the review, no other text.\"\n        ),\n        output_format=ProductReview,\n        model_alias=MODEL_ALIAS,\n    )\n)\n\ndata_designer.validate(config_builder)",
    "language": "python",
    "source_html": "<span style=\"color: #60A0B0; font-style: italic\"># We can create new columns using Jinja expressions that reference</span>\n<span style=\"color: #60A0B0; font-style: italic\"># existing columns, including attributes of nested objects.</span>\nconfig_builder<span style=\"color: #666\">.</span>add_column(\n    dd<span style=\"color: #666\">.</span>ExpressionColumnConfig(name<span style=\"color: #666\">=</span><span style=\"color: #4070A0\">&quot;customer_name&quot;</span>, expr<span style=\"color: #666\">=</span><span style=\"color: #4070A0\">&quot;{{ customer.first_name }} {{ customer.last_name }}&quot;</span>)\n)\n\nconfig_builder<span style=\"color: #666\">.</span>add_column(dd<span style=\"color: #666\">.</span>ExpressionColumnConfig(name<span style=\"color: #666\">=</span><span style=\"color: #4070A0\">&quot;customer_age&quot;</span>, expr<span style=\"color: #666\">=</span><span style=\"color: #4070A0\">&quot;{{ customer.age }}&quot;</span>))\n\nconfig_builder<span style=\"color: #666\">.</span>add_column(\n    dd<span style=\"color: #666\">.</span>LLMStructuredColumnConfig(\n        name<span style=\"color: #666\">=</span><span style=\"color: #4070A0\">&quot;product&quot;</span>,\n        prompt<span style=\"color: #666\">=</span>(\n            <span style=\"color: #4070A0\">&quot;Create a product in the &#39;{{ product_category }}&#39; category, focusing on products  &quot;</span>\n            <span style=\"color: #4070A0\">&quot;related to &#39;{{ product_subcategory }}&#39;. The target age range of the ideal customer is &quot;</span>\n            <span style=\"color: #4070A0\">&quot;{{ target_age_range }} years old. The product should be priced between $10 and $1000.&quot;</span>\n        ),\n        output_format<span style=\"color: #666\">=</span>Product,\n        model_alias<span style=\"color: #666\">=</span>MODEL_ALIAS,\n    )\n)\n\n<span style=\"color: #60A0B0; font-style: italic\"># We can even use if/else logic in our Jinja expressions to create more complex prompt patterns.</span>\nconfig_builder<span style=\"color: #666\">.</span>add_column(\n    dd<span style=\"color: #666\">.</span>LLMStructuredColumnConfig(\n        name<span style=\"color: #666\">=</span><span style=\"color: #4070A0\">&quot;customer_review&quot;</span>,\n        prompt<span style=\"color: #666\">=</span>(\n            <span style=\"color: #4070A0\">&quot;Your task is to write a review for the following product:</span><span style=\"color: #4070A0; font-weight: bold\">\\n\\n</span><span style=\"color: #4070A0\">&quot;</span>\n            <span style=\"color: #4070A0\">&quot;Product Name: {{ product.name }}</span><span style=\"color: #4070A0; font-weight: bold\">\\n</span><span style=\"color: #4070A0\">&quot;</span>\n            <span style=\"color: #4070A0\">&quot;Product Description: {{ product.description }}</span><span style=\"color: #4070A0; font-weight: bold\">\\n</span><span style=\"color: #4070A0\">&quot;</span>\n            <span style=\"color: #4070A0\">&quot;Price: {{ product.price }}</span><span style=\"color: #4070A0; font-weight: bold\">\\n\\n</span><span style=\"color: #4070A0\">&quot;</span>\n            <span style=\"color: #4070A0\">&quot;Imagine your name is {{ customer_name }} and you are from {{ customer.city }}, {{ customer.state }}. &quot;</span>\n            <span style=\"color: #4070A0\">&quot;Write the review in a style that is &#39;{{ review_style }}&#39;.&quot;</span>\n            <span style=\"color: #4070A0\">&quot;{</span><span style=\"color: #70A0D0; font-style: italic\">% i</span><span style=\"color: #4070A0\">f target_age_range == &#39;18-25&#39; %}&quot;</span>\n            <span style=\"color: #4070A0\">&quot;Make sure the review is more informal and conversational.</span><span style=\"color: #4070A0; font-weight: bold\">\\n</span><span style=\"color: #4070A0\">&quot;</span>\n            <span style=\"color: #4070A0\">&quot;{</span><span style=\"color: #70A0D0; font-style: italic\">% e</span><span style=\"color: #4070A0\">lse %}&quot;</span>\n            <span style=\"color: #4070A0\">&quot;Make sure the review is more formal and structured.</span><span style=\"color: #4070A0; font-weight: bold\">\\n</span><span style=\"color: #4070A0\">&quot;</span>\n            <span style=\"color: #4070A0\">&quot;{</span><span style=\"color: #70A0D0; font-style: italic\">% e</span><span style=\"color: #4070A0\">ndif %}&quot;</span>\n            <span style=\"color: #4070A0\">&quot;The review field should contain only the review, no other text.&quot;</span>\n        ),\n        output_format<span style=\"color: #666\">=</span>ProductReview,\n        model_alias<span style=\"color: #666\">=</span>MODEL_ALIAS,\n    )\n)\n\ndata_designer<span style=\"color: #666\">.</span>validate(config_builder)\n"
  },
  {
    "type": "markdown",
    "source": "### \ud83d\udd01 Iteration is key \u2013\u00a0preview the dataset!\n\n1. Use the `preview` method to generate a sample of records quickly.\n\n2. Inspect the results for quality and format issues.\n\n3. Adjust column configurations, prompts, or parameters as needed.\n\n4. Re-run the preview until satisfied."
  },
  {
    "type": "code",
    "source": "preview = data_designer.preview(config_builder, num_records=2)",
    "language": "python",
    "source_html": "preview <span style=\"color: #666\">=</span> data_designer<span style=\"color: #666\">.</span>preview(config_builder, num_records<span style=\"color: #666\">=</span><span style=\"color: #40A070\">2</span>)\n"
  },
  {
    "type": "code",
    "source": "# Run this cell multiple times to cycle through the 2 preview records.\npreview.display_sample_record()",
    "language": "python",
    "source_html": "<span style=\"color: #60A0B0; font-style: italic\"># Run this cell multiple times to cycle through the 2 preview records.</span>\npreview<span style=\"color: #666\">.</span>display_sample_record()\n"
  },
  {
    "type": "code",
    "source": "# The preview dataset is available as a pandas DataFrame.\npreview.dataset",
    "language": "python",
    "source_html": "<span style=\"color: #60A0B0; font-style: italic\"># The preview dataset is available as a pandas DataFrame.</span>\npreview<span style=\"color: #666\">.</span>dataset\n"
  },
  {
    "type": "markdown",
    "source": "### \ud83d\udcca Analyze the generated data\n\n- Data Designer automatically generates a basic statistical analysis of the generated data.\n\n- This analysis is available via the `analysis` property of generation result objects."
  },
  {
    "type": "code",
    "source": "# Print the analysis as a table.\npreview.analysis.to_report()",
    "language": "python",
    "source_html": "<span style=\"color: #60A0B0; font-style: italic\"># Print the analysis as a table.</span>\npreview<span style=\"color: #666\">.</span>analysis<span style=\"color: #666\">.</span>to_report()\n"
  },
  {
    "type": "markdown",
    "source": "### \ud83c\udd99 Scale up!\n\n- Happy with your preview data?\n\n- Use the `create` method to submit larger Data Designer generation jobs."
  },
  {
    "type": "code",
    "source": "results = data_designer.create(config_builder, num_records=10, dataset_name=\"tutorial-2\")",
    "language": "python",
    "source_html": "results <span style=\"color: #666\">=</span> data_designer<span style=\"color: #666\">.</span>create(config_builder, num_records<span style=\"color: #666\">=</span><span style=\"color: #40A070\">10</span>, dataset_name<span style=\"color: #666\">=</span><span style=\"color: #4070A0\">&quot;tutorial-2&quot;</span>)\n"
  },
  {
    "type": "code",
    "source": "# Load the generated dataset as a pandas DataFrame.\ndataset = results.load_dataset()\n\ndataset.head()",
    "language": "python",
    "source_html": "<span style=\"color: #60A0B0; font-style: italic\"># Load the generated dataset as a pandas DataFrame.</span>\ndataset <span style=\"color: #666\">=</span> results<span style=\"color: #666\">.</span>load_dataset()\n\ndataset<span style=\"color: #666\">.</span>head()\n"
  },
  {
    "type": "code",
    "source": "# Load the analysis results into memory.\nanalysis = results.load_analysis()\n\nanalysis.to_report()",
    "language": "python",
    "source_html": "<span style=\"color: #60A0B0; font-style: italic\"># Load the analysis results into memory.</span>\nanalysis <span style=\"color: #666\">=</span> results<span style=\"color: #666\">.</span>load_analysis()\n\nanalysis<span style=\"color: #666\">.</span>to_report()\n"
  },
  {
    "type": "markdown",
    "source": "## \u23ed\ufe0f Next Steps\n\nCheck out the following notebook to learn more about:\n\n- [Seeding synthetic data generation with an external dataset](https://nvidia-nemo.github.io/DataDesigner/latest/notebooks/3-seeding-with-a-dataset/)\n\n- [Providing images as context](https://nvidia-nemo.github.io/DataDesigner/latest/notebooks/4-providing-images-as-context/)\n\n- [Generating images](https://nvidia-nemo.github.io/DataDesigner/latest/notebooks/5-generating-images/)"
  }
] };
